<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Our Community in Unity - Empowering Futures, Together</title>
    <meta name="description" content="Our Community in Unity builds a united and resilient community in Cape Town through empowerment, education, and shared resources, guided by 'Each One Teach One.'">
    <link rel="icon" type="image/png" href="favicon.png"> <style>
        /* General Body & Typography */
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            line-height: 1.6;
            color: #333;
            background-color: #f4f4f4;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        h1, h2, h3, h4 {
            color: #007bff; /* Primary brand color */
            margin-bottom: 0.8em;
        }

        h1 { font-size: 2.5em; text-align: center; margin-bottom: 0.5em; }
        h2 { font-size: 2em; text-align: center; margin-bottom: 1em; }
        h3 { font-size: 1.7em; }
        h4 { font-size: 1.3em; }

        p {
            margin-bottom: 1em;
        }

        a {
            color: #007bff;
            text-decoration: none;
        }

        a:hover {
            text-decoration: underline;
        }

        ul {
            list-style: disc;
            margin-left: 20px;
            margin-bottom: 1em;
        }

        /* Buttons */
        .btn {
            display: inline-block;
            background-color: #007bff;
            color: white;
            padding: 10px 20px;
            border-radius: 5px;
            text-decoration: none;
            transition: background-color 0.3s ease;
            text-align: center;
            cursor: pointer;
        }

        .btn:hover {
            background-color: #0056b3;
            text-decoration: none;
        }

        .btn-small {
            padding: 8px 15px;
            font-size: 0.9em;
        }

        /* Header & Navigation */
        header {
            background-color: #333;
            color: white;
            padding: 15px 0;
            text-align: center;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }

        header h1 {
            margin: 0;
            color: white;
        }

        header .motto {
            font-style: italic;
            margin-top: 5px;
            font-size: 0.9em;
            color: #bbb;
        }

        header nav ul {
            list-style: none;
            padding: 0;
            margin-top: 15px;
            display: flex; /* For horizontal navigation */
            justify-content: center;
            flex-wrap: wrap; /* Allow wrapping on small screens */
        }

        header nav ul li {
            margin: 0 15px;
        }

        header nav ul li a {
            color: white;
            font-weight: bold;
            padding: 5px 10px;
            transition: color 0.3s ease;
        }

        header nav ul li a:hover {
            color: #a0c9ff;
            text-decoration: none;
        }

        /* Hero Section */
        .hero {
            background: url('images/hero-bg.jpg') no-repeat center center/cover; /* Image path relative to index.html */
            color: white;
            text-align: center;
            padding: 100px 20px;
            min-height: 500px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .hero::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.5); /* Dark overlay */
        }

        .hero-content {
            position: relative;
            z-index: 1;
            max-width: 800px;
            margin: 0 auto;
        }

        .hero-content h2 {
            font-size: 3em;
            margin-bottom: 20px;
            color: white; /* Ensure text is white over dark overlay */
        }

        .hero-content p {
            font-size: 1.2em;
            margin-bottom: 30px;
            color: #eee;
        }

        /* Sections */
        section {
            padding: 60px 0;
            border-bottom: 1px solid #eee;
        }

        section:last-of-type {
            border-bottom: none;
        }

        /* Flex Container for grid-like layouts */
        .flex-container {
            display: flex;
            flex-wrap: wrap;
            gap: 30px; /* Space between flex items */
            justify-content: center; /* Center items in the container */
            margin-top: 30px;
        }

        .flex-item {
            background-color: white;
            padding: 25px;
            border-radius: 8px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            flex: 1 1 calc(33.33% - 30px); /* Default to 3 items per row on large screens */
            box-sizing: border-box; /* Include padding and border in the element's total width */
            min-width: 280px; /* Minimum width for flex items before wrapping */
            text-align: left;
        }

        .program-list ul {
            list-style: none;
            padding: 0;
            margin-top: 15px;
        }

        .program-list ul li {
            margin-bottom: 8px;
            font-weight: bold;
            color: #555;
        }

        .program-list ul li ul {
            list-style: circle;
            font-weight: normal;
            margin-top: 5px;
            margin-left: 20px;
        }

        /* Leader Bio */
        .leader-bio {
            display: flex;
            flex-wrap: wrap;
            align-items: center;
            background-color: white;
            padding: 30px;
            margin-top: 40px;
            border-radius: 8px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }

        .leader-bio img {
            max-width: 150px;
            height: auto;
            border-radius: 50%;
            margin-right: 30px;
            margin-bottom: 20px; /* For mobile stacking */
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .leader-bio h3 {
            margin-top: 0;
            flex-basis: calc(100% - 180px); /* Adjust width to fit image */
            font-size: 1.6em;
        }

        .leader-bio p {
            flex-basis: 100%; /* Make paragraphs take full width below image */
            margin-bottom: 1em;
        }

        /* Footer */
        footer {
            background-color: #333;
            color: white;
            text-align: center;
            padding: 20px 0;
            margin-top: 30px;
        }

        footer p {
            margin: 0;
            font-size: 0.9em;
        }

        /* Responsive adjustments for general main.css */
        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }

            h1 { font-size: 2em; }
            h2 { font-size: 1.8em; }
            h3 { font-size: 1.5em; }

            .hero {
                padding: 80px 15px;
                min-height: 400px;
            }

            .hero-content h2 {
                font-size: 2.2em;
            }

            .hero-content p {
                font-size: 1em;
            }

            header nav ul {
                flex-direction: column; /* Stack navigation items vertically */
                align-items: center;
            }

            header nav ul li {
                margin: 10px 0;
            }

            .flex-item {
                flex: 1 1 100%; /* Stack flex items on small screens */
                max-width: 100%;
                margin-bottom: 20px;
            }

            .leader-bio {
                flex-direction: column;
                text-align: center;
            }

            .leader-bio img {
                margin-right: 0;
                margin-bottom: 20px;
            }

            .leader-bio h3 {
                flex-basis: 100%;
            }

            /* Adjust contact form inputs for full width */
            #contact-page form input[type="text"],
            #contact-page form input[type="email"],
            #contact-page form textarea {
                width: 100%;
                box-sizing: border-box; /* Ensure padding/border are included in width */
            }
        }

        /* Specific adjustments for tablets (e.g., between 768px and 1024px) */
        @media (min-width: 769px) and (max-width: 1024px) {
            .flex-item {
                flex: 1 1 calc(50% - 20px); /* 2 items per row */
                max-width: calc(50% - 20px);
            }
        }

        /* Basic CSS Animations (expand as needed) */
        .fade-in {
            opacity: 0;
            animation: fadeIn 1s ease-out forwards;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        /* Example: Hover effect for buttons */
        .btn {
            transform: scale(1);
            transition: transform 0.2s ease-in-out;
        }

        .btn:hover {
            transform: scale(1.05);
        }
    </style>
    </head>
<body>

    <header>
        <div class="container">
            <h1>Our Community in Unity</h1>
            <p class="motto">Each One Teach One</p>
            <nav>
                <ul>
                    <li><a href="#home">Home</a></li>
                    <li><a href="#about">About Us</a></li>
                    <li><a href="#what-we-do">What We Do</a></li>
                    <li><a href="#classroom">Classroom</a></li>
                    <li><a href="#get-involved">Get Involved</a></li>
                    <li><a href="#contact">Contact</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <section id="home" class="hero">
        <div class="hero-content">
            <h2>Empowering Futures, Transforming Lives in Cape Town</h2>
            <p>Building a united and resilient community, guided by the spirit of **Each One Teach One**.</p>
            <a href="#get-involved" class="btn">How You Can Help</a>
        </div>
    </section>

    <section id="about" class="container">
        <h2>About Us</h2>
        <p>At Our Community in Unity, we are driven by a profound commitment to fostering growth, sustainability, and positive transformation within our community. Our journey began with a clear purpose: to build a united and resilient community through empowerment, education, and shared resources.</p>
        <p>Our work is deeply rooted in our motto, **"Each One Teach One,"** a principle that guides every initiative and interaction. We believe that by empowering individuals with knowledge and support, they in turn can uplift others, creating a powerful ripple effect of positive change.</p>

        <h3>Our Mission, Vision, & Values</h3>
        <div class="flex-container">
            <div class="flex-item">
                <h4>Mission</h4>
                <p>To build a united and resilient community by empowering individuals through education, support, and shared resources. To create opportunities for growth and sustainable development for individuals and families. To engage in fundraising and partnerships to support community-driven projects.</p>
            </div>
            <div class="flex-item">
                <h4>Vision</h4>
                <p>To see a community where every individual is empowered, opportunities abound, and sustainable solutions drive social and cultural transformation.</p>
            </div>
            <div class="flex-item">
                <h4>Core Values</h4>
                <p>Transparency, Collaboration, Integrity, Innovation, and Community Empowerment.</p>
            </div>
        </div>

        <div class="leader-bio">
            <img src="images/logo.jpg" alt="Our Community in Unity Logo"> <h3>Our Founder's Journey: A Testament to "Each One Teach One"</h3>
            <p><strong>Cameron De Vries</strong>, Founder and Director of Our Community in Unity, embodies the very spirit of our motto, 'Each One Teach One.' Despite leaving formal schooling in Grade 9, Cameron's insatiable drive for knowledge and growth led to a remarkable journey of self-education and hands-on mastery. His diverse background includes sound engineering, event livestreaming, construction, security, and business development.</p>
            <p>His professional history, from entrepreneurial ventures in his late teens to excelling in technical and creative fields like the printing industry and film, demonstrates a powerful commitment to continuous learning and adaptation.</p>
            <p>Having personally navigated paths less traveled, Cameron understands the challenges and immense potential within our community. His journey is a living example that skills, determination, and the willingness to learn and share knowledge can create profound opportunities for growth, truly living the 'Each One Teach One' philosophy.</p>
            <p>This unique blend of diverse experience and a profound understanding of community needs drives 'Our Community in Unity' forward, ensuring our programs are practical, relevant, and deeply impactful.</p>
            <p>Cameron is supported in the governance of 'Our Community in Unity' by Bertha De Vries (Co-Founder) and Antonio Clifford Marais (Director), who are vital for our organizational compliance and strategic oversight.</p>
        </div>
    </section>

    <section id="what-we-do" class="container">
        <h2>What We Do: Our Programs & Impact</h2>
        <p>Our comprehensive programs are designed to uplift and empower every individual in our community, fostering growth and resilience. We provide essential support, innovative training, and sustainable solutions, all guided by the principle of **Each One Teach One**.</p>

        <div class="flex-container program-list">
            <div class="flex-item">
                <h3>Education & Training: Equipping for the Future</h3>
                <p>Our workshops, vocational training, and community education initiatives embody 'Each One Teach One,' fostering environments where skills are shared and knowledge is built collectively. We provide essential skills and cutting-edge knowledge to ensure our community members are competitive and empowered in the modern landscape. Our programs include:</p>
                <ul>
                    <li><strong>Digital Literacy & Innovation:</strong>
                        <ul>
                            <li><strong>AI Prompting Fundamentals:</strong> Unlock the power of Artificial Intelligence by learning how to effectively communicate with AI tools, a critical skill for the digital age.</li>
                            <li><strong>Email Marketing Strategies:</strong> Master the art of engaging audiences and promoting initiatives through effective email campaigns, essential for business and personal branding.</li>
                            <li>Basic Computer Skills & Online Safety.</li>
                        </ul>
                    </li>
                    <li><strong>Job Readiness & Vocational Skills:</strong>
                        <ul>
                            <li>CV Writing & Interview Preparation.</li>
                            <li>Professional Communication.</li>
                            <li>Online Job Searching.</li>
                        </ul>
                    </li>
                    <li><strong>Financial Literacy:</strong> Basic Budgeting & Saving.</li>
                </ul>
            </div>
            <div class="flex-item">
                <h3>Social Support & Community Empowerment</h3>
                <p>Through mentoring and resource sharing, we facilitate connections where 'Each One Teaches One,' providing crucial support and guidance for upliftment. We provide resources, mentoring, and counseling services to those in need.</p>
                <ul>
                    <li>Mentorship programs for youth and unemployed individuals.</li>
                    <li>Access to essential community resources.</li>
                    <li>Counseling and support services.</li>
                </ul>
            </div>
            <div class="flex-item">
                <h3>Sustainable Development Initiatives</h3>
                <p>Our initiatives promote 'Each One Teach One' by sharing best practices for environmental conservation and social housing, building a sustainable future together.</p>
                <ul>
                    <li>Environmental conservation projects.</li>
                    <li>Support for sustainable housing solutions.</li>
                    <li>Community development projects.</li>
                    </ul>
                </div>
            </div>

            <div class="flex-container">
                <div class="flex-item" style="flex-basis: 95%; max-width: 800px; margin-top: 40px;">
                    <h3>Our Community in Unity Podcast</h3>
                    <p>Dive deeper into the issues that matter to our community, hear inspiring stories of empowerment, and explore how 'Each One Teach One' is making a difference. Our podcast brings conversations, insights, and solutions directly to you.</p>
                    <p>Tune in to discussions on digital skills, community development, entrepreneurship, and much more, all designed to foster a united and resilient community.</p>
                    <a href="https://anchor.fm/s/fff9d9cc/podcast/rss" class="btn" target="_blank">Listen to the Podcast Now</a>
                    <div id="podcast-episodes">
                        <h4>Latest Episodes:</h4>
                        <ul id="episode-list">
                            <li>Loading episodes...</li>
                        </ul>
                    </div>
                </div>
            </div>
            <h3 style="margin-top: 40px;">Our First Pilot Project: Community Skills Boost Workshop Series</h3>
            <p>We're thrilled to launch our first concrete step towards empowerment! This pilot series, focusing on a specific, in-demand skill, will directly demonstrate the power of our 'Each One Teach One' approach.</p>
            <p><strong>Initial Workshop Focus:</strong> Our upcoming workshop will focus on "Introduction to AI Prompting for Job Seekers," teaching participants how to leverage AI to draft effective CVs, cover letters, and enhance their job search strategy.</p>
            <p><strong>Impact:</strong> This initial workshop aims to equip [X number, e.g., 10-15] participants with cutting-edge digital skills, directly enhancing their employability and confidence in the digital economy.</p>
            <p style="text-align: center; margin-top: 30px;"><a href="#get-involved" class="btn">Support Our Pilot Project</a></p>

            <h3 style="margin-top: 40px;">Stories of Change (Coming Soon!)</h3>
            <p style="text-align: center;">Hear firsthand from those whose lives we're transforming through the power of 'Each One Teach One'.</p>
        </section>

        <section id="classroom" class="container">
            <h2>Our Classroom: Learn & Grow</h2>
            <p style="text-align: center;">Welcome to the Our Community in Unity Classroom, where "Each One Teach One" comes to life! Become a member to access free coding and marketing courses, powerful AI tools (like Gemini, Claude, ChatGPT), and creative platforms (like Photopea, Canva) – all leveraging free tiers to help you learn and create without cost!</p>

            <div style="text-align: center; margin-top: 30px; margin-bottom: 50px;">
                <h3>Join Our Community!</h3>
                <p>Unlock all resources by becoming a free member. It's quick and easy!</p>
                <div id="auth-ui">
                    <form id="signup-form" style="margin-bottom: 20px;">
                        <p><label for="signup-email">Email:</label><br><input type="email" id="signup-email" placeholder="your@example.com" required></p>
                        <p><label for="signup-password">Password:</label><br><input type="password" id="signup-password" placeholder="Minimum 6 characters" required></p>
                        <p><button type="submit" class="btn">Sign Up Free</button></p>
                    </form>
                    <form id="login-form">
                        <p><label for="login-email">Email:</label><br><input type="email" id="login-email" placeholder="your@example.com" required></p>
                        <p><label for="login-password">Password:</label><br><input type="password" id="login-password" required></p>
                        <p><button type="submit" class="btn">Login</button></p>
                        <p><a href="#" id="reset-password-link">Forgot Password?</a></p>
                    </form>
                    <button id="logout-button" class="btn" style="display:none; margin-top: 15px;">Logout</button>
                </div>
                <p id="auth-status" style="margin-top: 10px; font-weight: bold;"></p>
            </div>

            <div id="classroom-content" style="display:none;"> <h3>Free Learning Resources & Tools (Members Only)</h3>
                <div class="flex-container program-list" id="resources-container">
                    <p>Loading resources...</p>
                </div>
                <p style="text-align: center; margin-top: 40px;">New resources and courses are added regularly. Stay tuned!</p>
            </div>

        </section>
        <section id="get-involved" class="container">
            <h2>Get Involved: Be a Part of the "Each One Teach One" Movement!</h2>
            <p style="text-align: center;">Your support, whether through time, resources, or financial contributions, directly empowers individuals and strengthens our community.</p>

            <div class="flex-container">
                <div class="flex-item">
                    <h3>Donate</h3>
                    <p>Your contribution directly fuels our 'Each One Teach One' programs, empowering individuals to learn, grow, and then share their knowledge with others. Every Rand makes a difference!</p>
                    <p><strong>Bank Details:</strong></p>
                    <p>Bank Name: Capitec Business Account</p>
                    <p>Account Name: Our Community in Unity</p>
                    <p>Account Number: 1053233388</p>
                    <p>Branch Code: [Insert Capitec Branch Code Here]</p> <p>SWIFT/BIC: [Insert SWIFT/BIC if applicable for international donations]</p>
                    <a href="#" class="btn">Donate Online (Coming Soon!)</a>
                </div>
                <div class="flex-item">
                    <h3>Volunteer</h3>
                    <p>Are you ready to live 'Each One Teach One'? Share your expertise as a workshop facilitator, mentor, or support our operations. Your knowledge can transform a life.</p>
                    <p>We need help with:</p>
                    <ul>
                        <li>Workshop Facilitation (especially in AI Prompting, Email Marketing, Job Readiness).</li>
                        <li>Mentorship for youth and job seekers.</li>
                        <li>Administrative support.</li>
                        <li>Event coordination.</li>
                    </ul>
                    <a href="mailto:info@ourcommunity.agency" class="btn">Volunteer Today</a>
                </div>
                <div class="flex-item">
                    <h3>Partner With Us</h3>
                    <p>Collaborate with 'Our Community in Unity' and extend the reach of 'Each One Teach One.' Together, we can create a ripple effect of empowerment and sustainable development across Cape Town.</p>
                    <p>We are seeking partnerships with local government, corporate sponsors, philanthropic organizations, and other NGOs.</p>
                    <a href="mailto:info@ourcommunity.agency" class="btn">Explore Partnership</a>
                </div>
            </div>
        </section>

        <section id="contact" class="container">
            <h2>Contact Us</h2>
            <p style="text-align: center;">We'd love to hear from you!</p>

            <div style="text-align: center; margin-bottom: 20px;">
                <h3 style="margin-bottom: 5px;">Get in Touch Directly</h3>
                <p><strong>Our Office:</strong> 94 Camellia street, Bonteheuwel, Cape Town, 7764, South Africa.</p>
                <p><strong>Phone:</strong> +27 (0) 815 693 926</p>
                <p><strong>Email:</strong> info@ourcommunity.agency</p>
                <p><strong>Office Hours:</strong> Monday - Friday: 9:00 AM - 5:00 PM</p>
            </div>

            <div style="text-align: center; margin-bottom: 40px;">
                <h3 style="margin-bottom: 10px;">Follow Us</h3>
                <p>
                    <a href="https://www.facebook.com/communityinunityza" target="_blank" style="margin: 0 10px; text-decoration: none; color: #3b5998; font-weight: bold;">Facebook</a>
                    <a href="https://x.com/ourcommunityag" target="_blank" style="margin: 0 10px; text-decoration: none; color: #000; font-weight: bold;">X (Twitter)</a>
                    <a href="https://www.instagram.com/ourcommunityza/" target="_blank" style="margin: 0 10px; text-decoration: none; color: #E1306C; font-weight: bold;">Instagram</a>
                    <a href="[Insert LinkedIn Link Here]" target="_blank" style="margin: 0 10px; text-decoration: none; color: #0077B5; font-weight: bold;">LinkedIn: Our Community in Unity</a>
                </p>
            </div>

            <form>
                <p><label for="name">Name:</label><br><input type="text" id="name" name="name" required></p>
                <p><label for="email">Email:</label><br><input type="email" id="email" name="email" required></p>
                <p><label for="message">Message:</label><br><textarea id="message" name="message" rows="5" required></textarea></p>
                <p><button type="submit" class="btn">Send Message</button></p>
            </form>
        </section>

        <footer>
            <div class="container">
                <p>&copy; 2024 Our Community in Unity. All rights reserved.</p>
            </div>
        </footer>

        <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
        <script>
            // Supabase client initialization (from main.js content)
            // IMPORTANT: REPLACE THESE WITH YOUR ACTUAL SUPABASE PROJECT URL AND PUBLIC (ANON) KEY
            const SUPABASE_URL = 'https://ycrmkofqhtlkexfbpljy.supabase.co'; // Your actual Supabase Project URL
            const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inljcm1rb2ZxaHRsa2V4ZmJwbGp5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDgzMDQyMTgsImV4cCI6MjA2Mzg4MDIxOH0.RttjxZ_VSoZbeFWmI6nD0mSQb40ozvoPT6u7eRd9Tpo'; // Your actual Supabase public (anon) key

            const supabase = Supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

            // Get DOM elements for authentication and classroom
            const authUi = document.getElementById('auth-ui');
            const signupForm = document.getElementById('signup-form');
            const loginForm = document.getElementById('login-form');
            const logoutButton = document.getElementById('logout-button');
            const authStatus = document.getElementById('auth-status');
            const classroomContent = document.getElementById('classroom-content');
            const resourcesContainer = document.getElementById('resources-container');
            const resetPasswordLink = document.getElementById('reset-password-link');

            // --- Authentication Functions ---

            // Function to check and update UI based on login status
            async function checkUser() {
                const { data: { user }, error } = await supabase.auth.getUser();

                if (error) {
                    console.error('Error getting user:', error);
                    authStatus.textContent = 'Error checking login status.';
                    authUi.style.display = 'block';
                    classroomContent.style.display = 'none';
                    logoutButton.style.display = 'none';
                    return;
                }

                if (user) {
                    authStatus.textContent = `Logged in as: ${user.email}`;
                    authUi.style.display = 'none'; // Hide signup/login forms
                    logoutButton.style.display = 'block'; // Show logout button
                    classroomContent.style.display = 'block'; // Show classroom content
                    fetchClassroomResources(); // Fetch and display resources for logged-in users
                } else {
                    authStatus.textContent = 'Please sign up or log in to access the Classroom.';
                    authUi.style.display = 'block'; // Show signup/login forms
                    logoutButton.style.display = 'none'; // Hide logout button
                    classroomContent.style.display = 'none'; // Hide classroom content
                }
            }

            // Signup handler
            if (signupForm) {
                signupForm.addEventListener('submit', async (event) => {
                    event.preventDefault();
                    const email = signupForm['signup-email'].value;
                    const password = signupForm['signup-password'].value;

                    authStatus.textContent = 'Signing up...';
                    const signupButton = signupForm.querySelector('button');
                    signupButton.disabled = true;

                    const { error } = await supabase.auth.signUp({
                        email: email,
                        password: password,
                    });

                    if (error) {
                        authStatus.textContent = `Signup Error: ${error.message}`;
                        console.error('Signup Error:', error);
                    } else {
                        authStatus.textContent = 'Sign up successful! Please check your email to confirm your account (if email confirmation is enabled).';
                        signupForm.reset();
                    }
                    signupButton.disabled = false;
                });
            }

            // Login handler
            if (loginForm) {
                loginForm.addEventListener('submit', async (event) => {
                    event.preventDefault();
                    const email = loginForm['login-email'].value;
                    const password = loginForm['login-password'].value;

                    authStatus.textContent = 'Logging in...';
                    const loginButton = loginForm.querySelector('button');
                    loginButton.disabled = true;

                    const { error } = await supabase.auth.signInWithPassword({
                        email: email,
                        password: password,
                    });

                    if (error) {
                        authStatus.textContent = `Login Error: ${error.message}`;
                        console.error('Login Error:', error);
                    } else {
                        authStatus.textContent = 'Login successful!';
                        loginForm.reset();
                        checkUser();
                    }
                    loginButton.disabled = false;
                });
            }

            // Logout handler
            if (logoutButton) {
                logoutButton.addEventListener('click', async () => {
                    authStatus.textContent = 'Logging out...';
                    logoutButton.disabled = true;

                    const { error } = await supabase.auth.signOut();

                    if (error) {
                        authStatus.textContent = `Logout Error: ${error.message}`;
                        console.error('Logout Error:', error);
                    } else {
                        authStatus.textContent = 'Logged out successfully.';
                        checkUser();
                    }
                    logoutButton.disabled = false;
                });
            }

            // Reset Password handler
            if (resetPasswordLink) {
                resetPasswordLink.addEventListener('click', async (event) => {
                    event.preventDefault();
                    const email = prompt("Please enter your email address to reset your password:");
                    if (email) {
                        authStatus.textContent = 'Sending password reset email...';
                        const { error } = await supabase.auth.resetPasswordForEmail(email, {
                            redirectTo: window.location.origin + '/reset-password.html', // Ensure this page exists!
                        });

                        if (error) {
                            authStatus.textContent = `Password Reset Error: ${error.message}`;
                            console.error('Password Reset Error:', error);
                        } else {
                            authStatus.textContent = 'Password reset email sent. Please check your inbox.';
                        }
                    }
                });
            }

            // --- Classroom Resources Loading ---

            async function fetchClassroomResources() {
                resourcesContainer.innerHTML = '<p>Loading resources...</p>';
                const { data: resources, error } = await supabase
                    .from('classroom_resources')
                    .select('*')
                    .order('category', { ascending: true })
                    .order('title', { ascending: true });

                if (error) {
                    console.error('Error fetching classroom resources:', error);
                    resourcesContainer.innerHTML = '<p>Error loading resources. Please try again later.</p>';
                    return;
                }

                if (resources.length === 0) {
                    resourcesContainer.innerHTML = '<p>No resources available yet. Check back soon!</p>';
                    return;
                }

                resourcesContainer.innerHTML = ''; // Clear loading message

                // Group resources by category
                const categorizedResources = {};
                resources.forEach(resource => {
                    if (!categorizedResources[resource.category]) {
                        categorizedResources[resource.category] = [];
                    }
                    categorizedResources[resource.category].push(resource);
                });

                // Render resources grouped by category
                for (const category in categorizedResources) {
                    const categorySection = document.createElement('div');
                    categorySection.className = 'classroom-category'; // Add a class for styling
                    categorySection.innerHTML = `<h3>${category}</h3><div class="flex-container"></div>`;
                    const categoryFlexContainer = categorySection.querySelector('.flex-container');

                    categorizedResources[category].forEach(resource => {
                        const resourceItem = document.createElement('div');
                        resourceItem.className = 'flex-item classroom-resource-item'; // Add class for styling
                        resourceItem.innerHTML = `
                            <h4><a href="${resource.url}" target="_blank" rel="noopener noreferrer">${resource.title}</a></h4>
                            <p>${resource.description}</p>
                            <a href="${resource.url}" target="_blank" rel="noopener noreferrer" class="btn btn-small">Go to Tool / Course</a>
                        `;
                        categoryFlexContainer.appendChild(resourceItem);
                    });
                    resourcesContainer.appendChild(categorySection);
                }
            }

            // Listen for authentication state changes and update UI
            supabase.auth.onAuthStateChange((event, session) => {
                console.log('Auth state changed:', event, session);
                checkUser();
            });

            // Initial check when the page loads
            checkUser();
        </script>

        <script>
            document.addEventListener('DOMContentLoaded', function() {
                const contactForm = document.querySelector('#contact form');
                const podcastRSSFeedUrl = 'https://anchor.fm/s/fff9d9cc/podcast/rss'; // Your podcast RSS feed URL
                const episodeList = document.getElementById('episode-list');


                // Using the SAME Supabase client as for authentication and classroom
                const supabaseContact = supabase; // Use the already initialized 'supabase' client

                if (contactForm) {
                    contactForm.addEventListener('submit', async function(event) {
                        event.preventDefault(); // Prevent default form submission

                        const submitButton = contactForm.querySelector('button[type="submit"]');
                        submitButton.disabled = true; // Disable button to prevent multiple submissions
                        submitButton.textContent = 'Sending...'; // Change button text

                        const formData = {
                            name: contactForm.name.value,
                            email: contactForm.email.value,
                            message: contactForm.message.value
                        };

                        try {
                            // 1. Insert data into Supabase database table (contact_submissions)
                            const { data, error } = await supabaseContact
                                .from('contact_submissions') // Your table name
                                .insert([formData]);

                            if (error) {
                                console.error('Supabase insert error:', error);
                                alert('Error submitting message: ' + error.message);
                            } else {
                                console.log('Submission data saved to DB:', data);

                                // 2. Invoke Supabase Edge Function to send email notification
                                const { data: edgeFunctionData, error: edgeFunctionError } = await supabaseContact.functions.invoke('send-contact-email', {
                                    body: formData, // Pass the form data to the function
                                    headers: { 'Content-Type': 'application/json' },
                                });

                                if (edgeFunctionError) {
                                    console.error('Edge Function invocation error:', edgeFunctionError);
                                    // Alert that message was saved, but email notification failed
                                    alert('Your message has been sent to our records, but we could not send an email notification. We will still get back to you!');
                                } else {
                                    console.log('Edge Function response:', edgeFunctionData);
                                    alert('Your message has been sent successfully!');
                                }

                                contactForm.reset(); // Clear the form
                            }
                        } catch (error) {
                            console.error('Network or unexpected error:', error);
                            alert('An unexpected error occurred. Please try again.');
                        } finally {
                            submitButton.disabled = false; // Re-enable button
                            submitButton.textContent = 'Send Message'; // Reset button text
                        }
                    });
                }

                // --- Podcast RSS Feed Fetching Logic (New) ---
                if (episodeList && podcastRSSFeedUrl) {
                    fetch(podcastRSSFeedUrl)
                        .then(response => response.text())
                        .then(str => (new window.DOMParser()).parseFromString(str, "text/xml"))
                        .then(data => {
                            const items = data.querySelectorAll("item");
                            episodeList.innerHTML = ''; // Clear "Loading episodes..."

                            const numberOfEpisodesToShow = 3; // Display top 3 episodes

                            items.slice(0, numberOfEpisodesToShow).forEach(item => {
                                const title = item.querySelector("title") ? item.querySelector("title").textContent : "No title";
                                const link = item.querySelector("link") ? item.querySelector("link").textContent : "#";
                                const pubDate = item.querySelector("pubDate") ? new Date(item.querySelector("pubDate").textContent).toLocaleDateString() : "No date";
                                const description = item.querySelector("description") ? item.querySelector("description").textContent : "No description available.";

                                const listItem = document.createElement('li');
                                listItem.innerHTML = `
                                    <strong><a href="${link}" target="_blank">${title}</a></strong>
                                    <br><small>${pubDate}</small>
                                    <p>${description.length > 150 ? description.substring(0, 150) + '...' : description}</p>
                                `;
                                episodeList.appendChild(listItem);
                            });
                        })
                        .catch(error => {
                            console.error('Error fetching or parsing RSS feed:', error);
                            episodeList.innerHTML = '<li>Error loading podcast episodes. Please try again later.</li>';
                        });
                }
            });
        </script>
        </body>
    </html>
